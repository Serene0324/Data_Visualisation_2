{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/Serene0324/Data_Visualisation_2/main/enrolment_school_district.csv"
  },
  "transform": [
    {"filter": "datum.sex == 'male' || datum.sex == 'female'"},
    {
      "calculate": "datum.sex == 'male' ? -toNumber(datum.students) : toNumber(datum.students)",
      "as": "students_signed"
    }
  ],
  "facet": {
    "row": {
      "field": "stage",
      "type": "nominal",
      "title": "Education Stage",
      "sort": ["post-secondary", "secondary", "primary"]
    }
  },
  "spec": {
    "width": 325,
    "height": 200,
    "layer": [
      {
        "mark": {"type": "bar"},
        "encoding": {
          "y": {
            "field": "state",
            "type": "nominal",
            "sort": "-x",
            "title": "State"
          },
          "x": {
            "field": "students_signed",
            "type": "quantitative",
            "title": "Number of Students",
            "axis": {"format": "s"}
          },
          "color": {
            "field": "sex",
            "type": "nominal",
            "scale": {
              "domain": ["male", "female"],
              "range": ["#90BAF9", "#FFB8F7"]
            },
            "legend": {"title": "Sex"}
          },
          "tooltip": [
            {"field": "state", "type": "nominal", "title": "State"},
            {"field": "stage", "type": "nominal", "title": "Education Stage"},
            {"field": "sex", "type": "nominal", "title": "Sex"},
            {"field": "students", "type": "quantitative", "title": "Number of Students", "format": "," }
          ]
        }
      }
    ]
  },
  "config": {
    "facet": {"columns": 1},
    "view": {"stroke": "transparent"}
  }
}

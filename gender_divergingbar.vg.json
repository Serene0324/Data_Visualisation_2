{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Gender Distribution of Student Enrolments by State and Education Stage (2022)",
  "data": {
    "url": "https://raw.githubusercontent.com/Serene0324/Homework_Week10/main/enrolment_school_district.csv"
  },
  "transform": [
    {"filter": "datum.sex == 'male' || datum.sex == 'female'"},
    {
      "calculate": "datum.sex == 'male' ? -toNumber(datum.students) : toNumber(datum.students)",
      "as": "students_signed"
    }
  ],
  "facet": {
    "row": {
      "field": "stage",
      "type": "nominal",
      "title": "Education Stage",
      "sort": ["post-secondary", "secondary", "primary"]
    }
  },
  "spec": {
    "width": 865,
    "height": 200,
    "layer": [
      {
        "mark": {"type": "bar"},
        "encoding": {
          "y": {
            "field": "state",
            "type": "nominal",
            "sort": "-x",
            "title": "State"
          },
          "x": {
            "field": "students_signed",
            "type": "quantitative",
            "title": "Number of Students (Male ← | → Female)",
            "axis": {"format": "s"}
          },
          "color": {
            "field": "sex",
            "type": "nominal",
            "scale": {
              "domain": ["male", "female"],
              "range": ["#90BAF9", "#FFB8F7"]
            },
            "legend": {"title": "Sex"}
          },
          "tooltip": [
            {"field": "state", "type": "nominal"},
            {"field": "stage", "type": "nominal"},
            {"field": "sex", "type": "nominal"},
            {"field": "students", "type": "quantitative"}
          ]
        }
      }
    ]
  },
  "config": {
    "facet": {"columns": 1},
    "view": {"stroke": "transparent"}
  }
}
